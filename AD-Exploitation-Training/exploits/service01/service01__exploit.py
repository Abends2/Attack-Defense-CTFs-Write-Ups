import requests
import socket
import json
import time


# Список URL-ов для запросов 
urls = [f"http://localhost:1100{i}/flags.json" for i in range(1, 6)]


def get_data_from_resource(url):
	resp = requests.get(url)
	return json.loads(resp.text)


def main_pwn(urls):
	for url in urls:
		flags = get_data_from_resource(url)

		# Если нужно посмотреть задержку сдачи флагов, то раскомментируйте строку ниже и запустите программу:
		# time.sleep(30)

		print(f"[+] Flags from {url}: {flags}")
		for flag in range(0, 4):
			enter_flag = flags["flags"][flag]
			# print("[+] Flag: ", enter_flag)

			# Отправляем данные по сокету 
			with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s: 
				s.connect(('localhost', 1337)) 
				s.send((enter_flag + "\n").encode('utf-8'))
				print(f"[+] Flagbot answer: {s.recv(1024)}")
	return 0


if __name__ == "__main__":
	main_pwn(urls)	
