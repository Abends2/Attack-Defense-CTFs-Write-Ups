import psycopg2


# Подкючаемся к БД через открытый порт
conn = psycopg2.connect(database="db", user="admin", password="admin", host="localhost", port=5432)

# Создаем метку для обращения к БД
cursor = conn.cursor()

# Запрос для получения всех таблиц в БД
cursor.execute("SELECT relname FROM pg_class WHERE relkind='r' AND relname !~ '^(pg_|sql_)';")

# Результат сохраняем в переменную для удобства дальнейшего обращения
tables = cursor.fetchall()	# Формат [('table1',), ('table2',), ('table3',)] - обращение по tables[i][0]


# Пробегаемся по таблицам БД (получаем данные из них)
for i in range(len(tables)):
	# Получаем все данные из таблиц
	cursor.execute(f"SELECT * FROM {tables[i][0]}")

	# Получаем все поля таблиц
	colnames = [desc[0] for desc in cursor.description]

	print(f"[+] Database - {tables[i][0]}:")
	print(colnames)

	data = cursor.fetchall()
	print(data, "\n")

conn.close()